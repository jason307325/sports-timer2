<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>é¸æ‰‹åˆ†æ®µç§’å·®è¨ˆç®—å™¨ 2026</title>

<style>
:root{
    --blue:#0071e3;
    --orange:#ff9500;
    --gray:#8e8e93;
    --bg:#f2f2f7;
}
html,body{
    margin:0;height:100%;background:var(--bg);
    touch-action:manipulation;user-select:none;
}
body{
    display:flex;justify-content:center;
    font-family:-apple-system,BlinkMacSystemFont;
}
.container{
    width:100%;max-width:500px;height:100svh;
    background:#fff;display:flex;flex-direction:column;
    padding:6px 10px;box-sizing:border-box;
}
h2{text-align:center;margin:2px 0;font-size:17px}

/* ===== æ™‚é–“è¼¸å…¥ ===== */
.time-box{
    display:flex;justify-content:center;align-items:center;
    font-variant-numeric:tabular-nums;margin-bottom:4px;
}
.time{
    width:70px;height:54px;line-height:54px;
    text-align:center;font-size:34px;font-weight:bold;
    border:2px solid #ccc;border-radius:10px;
}
.time.active{border-color:var(--blue);background:#eef3ff}
.sep{margin:0 6px;font-size:26px;color:#aaa}

/* ===== ç¢¼éŒ¶ ===== */
.stopwatch{
    display:flex;gap:4px;margin-bottom:4px;
}
.stopwatch button{
    flex:1;padding:8px;border:none;border-radius:8px;
    font-size:13px;font-weight:bold;
}
.btn-blue{background:var(--blue);color:#fff}
.btn-orange{background:var(--orange);color:#fff}
.btn-gray{background:var(--gray);color:#fff}
button:disabled{opacity:.4}

/* ===== è¡¨æ ¼ ===== */
.table-container{
    flex:1;
    min-height:55%;
    overflow-y:auto;
    border:1px solid #eee;border-radius:10px;
    margin-bottom:4px;
}
table{width:100%;border-collapse:collapse}
th,td{
    padding:6px 4px;text-align:center;
    border-bottom:1px solid #eee;
}
th{
    background:#f2f2f7;position:sticky;top:0;
}
.time-cell{color:var(--blue);font-weight:700}
.diff-plus{color:#ff3b30;font-weight:bold}
.diff-minus{color:#34c759;font-weight:bold}

/* ===== åŠŸèƒ½éµ ===== */
.actions{display:flex;gap:4px;margin-bottom:4px}
.actions button{
    flex:1;padding:10px;border:none;border-radius:8px;
    font-size:15px;font-weight:bold;
}
.btn-main{background:var(--blue);color:#fff}
.btn-clear{background:var(--gray);color:#fff}

/* ===== ç¸®å°éµç›¤ ===== */
.keypad{
    display:grid;grid-template-columns:repeat(3,1fr);
    gap:4px;
}
.keypad button{
    font-size:18px;padding:8px 0;
    border:none;border-radius:8px;
    background:#e5e5ea;
}
.keypad .delete{background:#ff3b30;color:#fff}
.keypad .action{background:var(--blue);color:#fff}
</style>
</head>

<body>
<div class="container">

<h2>ğŸŠ é¸æ‰‹åˆ†æ®µç§’å·®è¨ˆç®—å™¨ 2026</h2>

<div class="time-box">
<div id="min" class="time">00</div><span class="sep">:</span>
<div id="sec" class="time">00</div><span class="sep">.</span>
<div id="ms" class="time">00</div>
</div>

<div class="stopwatch">
<button id="swStart" class="btn-blue">â–¶ï¸ é–‹å§‹</button>
<button id="swPause" class="btn-orange">â¸ æš«åœ</button>
<button id="swLap" class="btn-blue">â± åˆ†æ®µ</button>
<button id="swStop" class="btn-gray">â¹ çµæŸ</button>
</div>

<div class="table-container">
<table>
<thead>
<tr>
<th>æ®µ</th><th>ç¸½æ™‚é–“</th><th>åˆ†æ®µ</th><th>ç§’å·®</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

<div class="actions">
<button id="save" class="btn-main">âœ“ æ–°å¢ç´€éŒ„</button>
<button id="clear" class="btn-clear">ğŸ—‘ æ¸…é™¤</button>
</div>

<div class="keypad" id="keypad">
<button data="7">7</button><button data="8">8</button><button data="9">9</button>
<button data="4">4</button><button data="5">5</button><button data="6">6</button>
<button data="1">1</button><button data="2">2</button><button data="3">3</button>
<button class="delete" data="del">âŒ«</button>
<button data="0">0</button>
<button class="action" data="save">âœ“</button>
</div>

</div>

<script>
const $=id=>document.getElementById(id);
const fields=["min","sec","ms"];
let idx=0, firstInput=true;
let records=[];
let stopwatchLocked=false;

/* ===== è¼¸å…¥æ ¼é»é¸ ===== */
fields.forEach((f,i)=>{
    $(f).onclick=()=>{
        idx=i;
        firstInput=true;
        highlight();
    };
});
function highlight(){
    fields.forEach((f,i)=>{
        $(f).classList.toggle("active",i===idx);
    });
}
highlight();

/* ===== éµç›¤ ===== */
document.querySelectorAll("#keypad button").forEach(b=>{
    b.onclick=()=>{
        const v=b.getAttribute("data");
        if(v==="del") del();
        else if(v==="save") saveRecord();
        else input(v);
    };
});

function input(n){
    const f=$(fields[idx]);
    f.textContent=firstInput?n:f.textContent+n;
    if(f.textContent.length>2) f.textContent=f.textContent.slice(-2);
    firstInput=false;
    if(f.textContent.length===2){
        idx=Math.min(idx+1,2);
        firstInput=true;
    }
    highlight();
}
function del(){
    if($(fields[idx]).textContent!=="00"){
        $(fields[idx]).textContent="00";
    }else if(idx>0){
        idx--;
        $(fields[idx]).textContent="00";
    }
    firstInput=true;
    highlight();
}

/* ===== å„²å­˜ ===== */
function saveRecord(){
    if(stopwatchLocked) return;
    const t=+$("min").textContent*60
        + +$("sec").textContent
        + +$("ms").textContent/100;
    if(t<=0 || records.length>=30) return;
    records.push({total:t});
    renderTable();
}

/* ===== æ¸…é™¤ ===== */
clear.onclick=()=>{
    records=[];
    stopwatchLocked=false;
    swStart.disabled=false;
    renderTable();
};

/* ===== ç¢¼éŒ¶ ===== */
let running=false,startTime=0,elapsed=0,raf=null;

function tick(){
    elapsed=(performance.now()-startTime)/1000;
    setTime(elapsed);
    raf=requestAnimationFrame(tick);
}
function setTime(t){
    min.textContent=String(Math.floor(t/60)).padStart(2,"0");
    sec.textContent=String(Math.floor(t%60)).padStart(2,"0");
    ms.textContent=String(Math.floor((t%1)*100)).padStart(2,"0");
}

swStart.onclick=()=>{
    if(running || stopwatchLocked) return;
    running=true;
    startTime=performance.now()-elapsed*1000;
    tick();
};
swPause.onclick=()=>{
    running=false;
    cancelAnimationFrame(raf);
};
swLap.onclick=()=>{
    if(running) saveRecord();
};
swStop.onclick=()=>{
    running=false;
    cancelAnimationFrame(raf);
    stopwatchLocked=true;
    swStart.disabled=true;
};

/* ===== è¡¨æ ¼ ===== */
function renderTable(){
    records.sort((a,b)=>a.total-b.total);
    tbody.innerHTML="";
    records.forEach((r,i)=>{
        const split=i?r.total-records[i-1].total:r.total;
        let diff="-",cls="";
        if(i>0){
            const prev=i>1
                ?records[i-1].total-records[i-2].total
                :records[i-1].total;
            const d=split-prev;
            diff=(d>0?"+":"")+d.toFixed(2);
            cls=d>0?"diff-plus":"diff-minus";
        }
        tbody.innerHTML+=`
        <tr>
        <td>${i+1}</td>
        <td class="time-cell">${fmt(r.total)}</td>
        <td>${fmt(split)}</td>
        <td class="${cls}">${diff}</td>
        </tr>`;
    });
}
function fmt(s){
    const m=Math.floor(s/60);
    const ss=(s%60).toFixed(2).padStart(5,"0");
    return `${String(m).padStart(2,"0")}:${ss}`;
}
</script>

</body>
</html>
