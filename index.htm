<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>分段記錄器 - 四鈕平衡版</title>
<style>
:root {
    --bg-dark: #0d1117; 
    --panel-dark: #161b22; 
    --text-light: #fff;
    --neon-blue: #00a2ff;
    --neon-green: #4cd964;
    --neon-red: #ff3b30;
    --neon-orange: #ff9500;
}

* { box-sizing: border-box; margin:0; padding:0; touch-action: manipulation; }
html, body { height: 100dvh; width:100%; background: var(--bg-dark); color: var(--text-light); font-family: -apple-system, system-ui, sans-serif; overflow: hidden; }
button { cursor: pointer; border: none; transition: all 0.2s ease; -webkit-tap-highlight-color: transparent; }
button:active { transform: scale(0.95); }

.app-container { display:flex; flex-direction:column; height:100%; width:100%; max-width:800px; margin:0 auto; }

header { display:flex; background:#05070a; border-bottom:2px solid #1a2028; flex-shrink:0; }
header div.tab-btn { flex:1; text-align:center; padding:15px 0; font-size:14px; font-weight:900; color:#666; border-bottom:3px solid transparent; transition: all 0.3s ease; }
header div.tab-btn.active { color: var(--neon-blue); border-bottom-color: var(--neon-blue); background: rgba(0,162,255,0.05); }

.content-wrapper { flex:1; display:flex; position:relative; overflow:hidden; }
.page { position:absolute; top:0; left:0; width:100%; height:100%; display:none; flex-direction:column; }
.page.active { display:flex; }

.table-container { flex:1; overflow-y:auto; padding:10px; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; }
table { width:100%; border-collapse: collapse; margin-bottom: 20px; }
th, td { padding:10px 5px; text-align:center; font-size:13px; border-bottom:1px solid #222; }
th { position:sticky; top:0; background:var(--panel-dark); color:#888; z-index:5; }

.control-panel { flex-shrink:0; padding:15px; background: var(--panel-dark); border-top:1px solid #1a2028; display:flex; flex-direction:column; gap:12px; }

.time-box { display:flex; justify-content:center; align-items:center; gap:6px; margin-bottom: 5px; }
.time-input { 
    width:80px; 
    height:60px; 
    line-height:60px; 
    text-align:center; 
    border:2px solid #333; 
    border-radius:12px; 
    background:#090c10; 
    font-size:32px; 
    font-weight:700; 
    color:#fff; 
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}
.time-input.active { 
    border-color: var(--neon-blue); 
    background: rgba(0,162,255,0.1);
    box-shadow: 0 0 20px rgba(0,162,255,0.4);
}
.time-box span { 
    font-size: 28px; 
    font-weight: 700; 
    color: #666; 
}

.keypad { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; }
.keypad button { 
    padding:18px; 
    border-radius:12px; 
    font-size:24px; 
    font-weight:700; 
    background:#1c222d; 
    color:#fff; 
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
.keypad button:active { 
    background:#252d3a; 
    box-shadow: 0 1px 3px rgba(0,0,0,0.4) inset;
}
.keypad .k-del { background: #2d1f1f; color: var(--neon-red); }
.keypad .k-del:active { background: #3d2525; }
.keypad .k-ok { background: var(--neon-blue); }
.keypad .k-ok:active { background: #0090e0; }

.sw-view { text-align:center; padding:10px 0; }
#swDisplay { 
    font-family:"Courier New", monospace; 
    font-size: clamp(3.2rem,12vw,4.5rem); 
    font-weight:800; 
    font-variant-numeric: tabular-nums; 
    letter-spacing:-2px; 
}

.sw-actions { display:grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap:10px; }
.sw-actions button { 
    padding:18px 0; 
    border-radius:12px; 
    font-size:18px; 
    font-weight:700; 
    color:#fff; 
    width: 100%; 
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
.btn-start { background: var(--neon-green); }
.btn-lap { background: var(--neon-blue); }
.btn-pause { background: var(--neon-orange); }
.btn-stop { background: var(--neon-red); }
.btn-lock { opacity: 0.15; pointer-events: none; filter: grayscale(1); }

.btn-del-row { 
    width:26px; 
    height:26px; 
    border-radius:50%; 
    background:#2d1f1f; 
    color: var(--neon-red); 
    font-weight:bold; 
    font-size: 16px;
}

.btn-clear-footer { 
    width:100%; 
    padding:15px; 
    background:transparent; 
    color:#555; 
    font-size:12px; 
    border-top: 1px dashed #333; 
    margin-top: 10px; 
}

.diff-up { color: var(--neon-red); }
.diff-down { color: var(--neon-green); }
</style>
</head>
<body>

<div class="app-container">
<header>
    <div id="tabManual" class="tab-btn active" onclick="switchTab('manual')">手動輸入</div>
    <div id="tabSW" class="tab-btn" onclick="switchTab('sw')">碼錶計時</div>
</header>

<main class="content-wrapper">

<div id="page-manual" class="page active">
    <div class="table-container" id="manualScrollArea">
        <table>
            <thead>
            <tr><th>段</th><th>總時間</th><th>分段</th><th>秒差</th><th></th></tr>
            </thead>
            <tbody id="tbody"></tbody>
        </table>
        <button id="btnManualClear" class="btn-clear-footer">✕ 清空所有手動紀錄</button>
    </div>

    <div class="control-panel">
        <div class="time-box">
            <div id="m_min" class="time-input active">00</div><span>:</span>
            <div id="m_sec" class="time-input">00</div><span>.</span>
            <div id="m_ms" class="time-input">00</div>
        </div>

        <div class="keypad">
            <button class="k-num">7</button><button class="k-num">8</button><button class="k-num">9</button>
            <button class="k-num">4</button><button class="k-num">5</button><button class="k-num">6</button>
            <button class="k-num">1</button><button class="k-num">2</button><button class="k-num">3</button>
            <button class="k-del" id="keyDel">⌫</button><button class="k-num">0</button><button class="k-ok" id="keySave">✓</button>
        </div>
    </div>
</div>

<div id="page-sw" class="page">
    <div class="table-container" id="swScrollArea">
        <table>
            <thead>
            <tr><th>段</th><th>總時間</th><th>分段</th><th>秒差</th><th></th></tr>
            </thead>
            <tbody id="tbodySW"></tbody>
        </table>
        <button id="btnSWClear" class="btn-clear-footer">✕ 重置碼錶並清空紀錄</button>
    </div>

    <div class="control-panel">
        <div class="sw-view"><div id="swDisplay">00:00.00</div></div>
        <div class="sw-actions">
            <button id="swStart" class="btn-start">開始</button>
            <button id="swLap" class="btn-lap btn-lock">分段</button>
            <button id="swPause" class="btn-pause btn-lock">暫停</button>
            <button id="swStop" class="btn-stop btn-lock">結束</button>
        </div>
    </div>
</div>

</main>
</div>

<script>
/* 原 JS 全部保留，未更動 */
</script>

</body>
</html>
