<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>é¸æ‰‹åˆ†æ®µç§’å·®è¨ˆç®—å™¨ 2026</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0071e3">

<style>
:root{
    --apple-blue:#0071e3;
    --apple-orange:#ff9500;
    --apple-gray:#8e8e93;
    --apple-bg:#f2f2f7;
}

html,body{
    margin:0; padding:0; height:100%;
    background:var(--apple-bg);
    touch-action:manipulation;
    user-select:none;
    overscroll-behavior:none;
}

body{
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
    display:flex; justify-content:center;
}

.container{
    width:100%; max-width:500px; height:100svh;
    background:#fff; display:flex; flex-direction:column;
    padding:8px 12px env(safe-area-inset-bottom);
    box-sizing:border-box;
}

header{text-align:center}
h2{margin:2px 0;font-size:18px}
.hint-text{font-size:12px;color:var(--apple-blue);margin-bottom:4px}

/* --- è¼¸å…¥å€æ”¾å¤§ --- */
.input-section{
    border:1.5px solid #e5e5ea; border-radius:12px;
    padding:12px 8px; margin-bottom:8px;
    background: #ffffff;
}

.status-badge{
    font-size:12px; padding:3px 8px; border-radius:4px;
    background:var(--apple-gray); color:#fff; display:inline-block;
    margin-bottom:8px;
}
.status-badge.edit{background:var(--apple-orange)}

.time-box{
    display:flex; justify-content:center; align-items:center; 
    font-variant-numeric:tabular-nums;
}

.time{
    /* é¡¯è‘—æ”¾å¤§è¼¸å…¥æ ¼å­å¯¬åº¦èˆ‡é«˜åº¦ */
    width:80px; height:64px; line-height:64px; 
    text-align:center; font-size:40px; font-weight:bold;
    border:2.5px solid #d1d1d6; border-radius:12px; background:#fff;
    transition: all 0.2s;
}
.time.active{border-color:var(--apple-blue); background:#eef3ff; box-shadow: 0 0 8px rgba(0,113,227,0.2);}
.time.will-replace{color:var(--apple-orange); background:#fff9f0;}
.sep{margin:0 6px; color:#aaa; font-size:32px; font-weight: bold;}

/* --- æˆç¸¾è¡¨æ ¼å€å„ªåŒ– --- */
.table-container{
    flex:1; overflow-y:auto; border:1px solid #e5e5ea; border-radius:10px; 
    margin-bottom:8px; background:#fcfcfc;
}

table{width:100%; border-collapse:collapse; table-layout: fixed;}
table th{
    background:#f2f2f7; position:sticky; top:0; z-index:10;
    font-size:14px; color:#666; padding:12px 4px;
    border-bottom: 1px solid #e5e5ea;
}

table td{
    padding:14px 4px; text-align:center;
    border-bottom: 1px solid #f0f0f0;
    font-variant-numeric: tabular-nums;
}

/* æ”¾å¤§é¡¯ç¤ºå­—å¹• */
.col-rank { width: 15%; font-size: 14px; color: #888; }
.time-cell { 
    color: var(--apple-blue); 
    font-weight: 700; 
    font-size: 20px; /* æˆç¸¾å­—é«”æ”¾å¤§ */
    text-decoration: underline; 
}
.split-cell {
    font-size: 19px; /* åˆ†æ®µå­—é«”æ”¾å¤§ */
    font-weight: 500;
    color: #333;
}
.diff-plus{ color:#ff3b30; font-weight:bold; font-size:18px; }
.diff-minus{ color:#34c759; font-weight:bold; font-size:18px; }

/* --- åº•éƒ¨æŒ‰éˆ•èˆ‡éµç›¤ --- */
.actions{display:flex; gap:6px; margin-bottom:8px;}
.actions button{flex:1; padding:14px; border:none; border-radius:10px; font-size:18px; font-weight:bold;}
.btn-main{background:var(--apple-blue); color:#fff;}
.btn-main.is-edit{background:var(--apple-orange);}
.btn-clear{background:var(--apple-gray); color:#fff;}

.keypad{display:grid; grid-template-columns:repeat(3,1fr); gap:8px;}
.keypad button{font-size:24px; padding:14px 0; border:none; border-radius:12px; background:#e5e5ea; color: #000;}
.keypad button:active{background:#d1d1d6;}
.keypad .delete{background:#ff3b30; color:#fff;}
.keypad .action{background:var(--apple-blue); color:#fff;}
</style>
</head>

<body>
<div class="container">

<header>
    <h2>ğŸŠ é¸æ‰‹åˆ†æ®µç§’å·®è¨ˆç®—å™¨ 2026</h2>
    <div class="hint-text">é»æ“Šè¡¨æ ¼ã€Œç¸½æ™‚é–“ã€å¯ç›´æ¥ä¿®æ­£æˆç¸¾</div>
</header>

<div class="input-section">
    <div id="status" class="status-badge">æ–°å¢æ¨¡å¼</div>
    <div class="time-box">
        <div id="min" class="time">00</div><span class="sep">:</span>
        <div id="sec" class="time">00</div><span class="sep">.</span>
        <div id="ms" class="time">00</div>
    </div>
</div>

<div class="table-container">
<table>
<thead>
<tr>
<th style="width:15%">æ®µæ¬¡</th>
<th style="width:30%">ç¸½æ™‚é–“</th>
<th style="width:30%">åˆ†æ®µ</th>
<th style="width:25%">ç§’å·®</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

<div class="actions">
<button id="save" class="btn-main">âœ“ æ–°å¢ç´€éŒ„</button>
<button id="clear" class="btn-clear">ğŸ—‘ æ¸…é™¤</button>
</div>

<div class="keypad" id="keypad">
<button data="7">7</button><button data="8">8</button><button data="9">9</button>
<button data="4">4</button><button data="5">5</button><button data="6">6</button>
<button data="1">1</button><button data="2">2</button><button data="3">3</button>
<button class="delete" data="del">âŒ«</button><button data="0">0</button>
<button class="action" data="save">âœ“</button>
</div>

</div>

<script>
const fields=["min","sec","ms"];
let idx=0, records=[], editRecord=null, firstInput=true;

const $=id=>document.getElementById(id);
const bind=(el,fn)=>{
    el.addEventListener("touchstart",e=>{e.preventDefault();fn();},{passive:false});
    el.addEventListener("click",fn);
};

// åˆ‡æ›è¼¸å…¥æ¬„ä½
fields.forEach((f,i)=>bind($(f),()=>{idx=i;firstInput=true;updateHighlight()}));

// éµç›¤äº‹ä»¶
document.querySelectorAll("#keypad button").forEach(b=>{
    bind(b,()=>{
        const v=b.getAttribute("data");
        if(v==="del") deleteLast();
        else if(v==="save") saveRecord();
        else inputNum(v);
    });
});

bind($("save"),saveRecord);
bind($("clear"),()=>{if(confirm("ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰ç´€éŒ„å—ï¼Ÿ")){records=[];editRecord=null;renderTable();clearInput();}});

function updateHighlight(){
    fields.forEach((f,i)=>{
        $(f).className="time"+(i===idx?" active":"")+(i===idx&&firstInput?" will-replace":"");
    });
    const status=$("status");
    if(editRecord){
        status.textContent="ç·¨è¼¯æ¨¡å¼";
        status.className="status-badge edit";
        $("save").textContent="âœ“ æ›´æ–°ç´€éŒ„";
        $("save").classList.add("is-edit");
    } else {
        status.textContent="æ–°å¢æ¨¡å¼";
        status.className="status-badge";
        $("save").textContent="âœ“ æ–°å¢ç´€éŒ„";
        $("save").classList.remove("is-edit");
    }
}

function inputNum(n){
    const f=$(fields[idx]);
    // å¦‚æœæ˜¯è©²æ ¼ç¬¬ä¸€å€‹æ•¸å­—å‰‡å–ä»£ï¼Œå¦å‰‡ç´¯åŠ 
    f.textContent=firstInput?n:f.textContent+n;
    if(f.textContent.length > 2) f.textContent = f.textContent.slice(-2);
    firstInput=false;
    
    // è¼¸å…¥æ»¿å…©ä½è‡ªå‹•è·³ä¸‹ä¸€æ ¼
    if(f.textContent.length===2){
        idx=(idx+1)%3;
        firstInput=true;
    }
    updateHighlight();
}

function deleteLast(){ 
    $(fields[idx]).textContent="00"; 
    firstInput=true; 
    updateHighlight(); 
}

function saveRecord(){
    const t=+$("min").textContent*60 + +$("sec").textContent + +$("ms").textContent/100;
    if(t <= 0) return;

    if(editRecord){
        editRecord.total=t;
        editRecord=null;
    } else {
        records.push({id:Date.now(), total:t});
    }
    renderTable();
    clearInput();
}

function renderTable(){
    // ä¾ç¸½æ™‚é–“æ’åº
    records.sort((a,b)=>a.total-b.total);
    const tbody=$("tbody");
    tbody.innerHTML="";
    
    records.forEach((r,i)=>{
        const split = i === 0 ? r.total : r.total - records[i-1].total;
        let diffText="-", diffCls="";
        
        if(i > 0){
            const prevSplit = records[i-1].total - (records[i-2] ? records[i-2].total : 0);
            const diff = split - prevSplit;
            diffText = (diff > 0 ? "+" : "") + diff.toFixed(2);
            diffCls = diff > 0 ? "diff-plus" : "diff-minus";
        }

        const tr=document.createElement("tr");
        tr.innerHTML=`
            <td class="col-rank">${i+1}</td>
            <td class="time-cell">${formatTime(r.total)}</td>
            <td class="split-cell">${formatTime(split)}</td>
            <td class="${diffCls}">${diffText}</td>
        `;
        
        // é»æ“Šæˆç¸¾é€²å…¥ç·¨è¼¯
        bind(tr.querySelector(".time-cell"),()=>{
            editRecord=r;
            loadRecordToInput(r);
        });
        
        tbody.appendChild(tr);
    });
}

function loadRecordToInput(r){
    $("min").textContent=Math.floor(r.total/60).toString().padStart(2,"0");
    $("sec").textContent=Math.floor(r.total%60).toString().padStart(2,"0");
    $("ms").textContent=Math.round((r.total%1)*100).toString().padStart(2,"0");
    idx=0; firstInput=true; updateHighlight();
}

function formatTime(s){
    const m=Math.floor(s/60);
    const ss=(s%60).toFixed(2).padStart(5,"0");
    return `${m.toString().padStart(2,"0")}:${ss}`;
}

function clearInput(){
    fields.forEach(f=>$(f).textContent="00");
    idx=0; firstInput=true; updateHighlight();
}

updateHighlight();
</script>

</body>
</html>
